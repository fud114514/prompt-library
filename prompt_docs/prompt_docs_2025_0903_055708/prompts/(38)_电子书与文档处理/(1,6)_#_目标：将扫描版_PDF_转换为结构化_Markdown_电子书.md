请将以下电子书文本进行深度格式化，转换成一份结构清晰、符合标准的 Markdown 文档。处理时请严格遵循以下所有要求：

**待处理文本:**


[在此处粘贴你的电子书文本]

**格式化要求:**

1.  **元数据提取 (如果可能):**
    *   尝试识别文本开头的书名、作者等信息。
    *   如果识别成功，格式化为 YAML Front Matter，放置在文档顶部（例如：`---\ntitle: 书名\nauthor: 作者\n---`）。

2.  **结构识别与标记:**
    *   智能识别文本中的章节标题、子标题等层级结构。
    *   使用 Markdown 的 `#`, `##`, `###` 等语法进行分级标记（最多到 H3 或 H4，视文本实际层级而定）。
    *   如果层级关系不明确，请做出最合理的猜测，或保守地使用较低级别的标题。

3.  **段落修复与整理:**
    *   合并因不必要的硬换行符（非逻辑分段）而断开的段落，确保每个逻辑段落自然流畅。
    *   移除段落之间多余的空行，但保留段落间的标准 Markdown 分隔（通常是一个空行）。
    *   移除每行开头和结尾处不必要的空格或制表符。
    *   规范化处理单词间的空格，避免出现连续多个空格。

4.  **基础 Markdown 格式转换:**
    *   将文本中的有序列表（如 `1.`, `a.`, `i.`）和无序列表（如 `*`, `-`, `•`）转换为标准的 Markdown 列表格式。注意保持正确的缩进层级。
    *   将原文中明确表示强调的文本（如加粗、斜体标识）转换为 Markdown 的 `**粗体**` 和 `*斜体*`。
    *   识别并转换引用块（通常是缩进或有特殊标记的段落）为 Markdown 的 `> ` 格式。
    *   识别并转换文本中表示分隔线的符号（如 `---`, `***`, `* * *`）为 Markdown 的水平分割线 (`---`)。

5.  **处理特定内容元素:**
    *   **超链接:** 将文本中可识别的 URL 自动转换为 Markdown 链接格式 `[URL](URL)`。如果能识别出链接对应的描述文本，则使用 `[描述文本](URL)` 格式。
    *   **代码块:** 识别代码片段，并使用 Markdown 的 ``` 包裹。如果可能，尝试识别代码语言并在 ``` 后添加标识符（如 ```python）。
    *   **图片引用:** 保留文本中对图片的引用说明（如 `[图 1-1]` 或 `见图 X`）。如果需要占位符，请使用 `![图片描述占位符]()`。
    *   **表格:** 如果原文中存在简单的、用空格或符号分隔的文本表格，请尝试将其转换为 Markdown 表格格式。如果表格复杂或格式混乱，保留原始文本形式并用注释或标记说明此处为表格。

6.  **注释/尾注的特殊处理（核心新功能）:**
    *   识别文内的注释标记（如 `[1]`, `[^1]`, `(注1)` 等）和对应的注释文本。
    *   **重要:** 将所有识别到的注释文本收集起来，并统一移动到文档的**最末尾**。
    *   根据注释在正文中**首次出现**的先后顺序，对其进行**从 1 开始的重新编号**。
    *   将正文中的原注释标记替换为新的 Markdown 脚注标记 `[^n]` (其中 n 是新的编号)。
    *   在文档末尾，使用一个二级标题 `## 注释` 或 `## 尾注` 来引导注释列表。
    *   每个注释条目使用 Markdown 脚注定义格式：`[^n]: 注释内容`，其中 `n` 是重新编号后的数字。

7.  **字符与实体处理:**
    *   正确处理和转义 Markdown 语法中的特殊字符（如 `*`, `_`, `#`, `[`, `]` 等），确保它们在需要时显示为字面量。
    *   将常见的 HTML 实体（如 ` `, `<`, `>`, `&`）转换为它们对应的字符或 Markdown 等效表示。

8.  **通用规则与假设:**
    *   Markdown 风格: 默认使用 GitHub Flavored Markdown (GFM) 规范。
    *   语言: 假设文本主要语言为**中文**。请根据中文的标点符号习惯进行处理，将全角或非标准符号转换为标准的中文全角符号（如 `，。！？：；“‘”’（）【】`）。
    *   歧义处理: 当遇到格式或结构解析不明确的情况时，优先保证内容不丢失和语义准确，可以适度保留原始格式或添加 Markdown 注释说明（例如 `<!-- 原始格式可能为列表 -->`）。
    *   内容完整性: 格式化过程中，**绝对不能删除、修改原文的有效内容和语义**。

9.  **最终输出:**
    *   将经过以上所有步骤处理、整理、格式化后的**全部内容**，以单一的 Markdown 文本形式输出。
    *   确保最终输出的所有内容都**被包裹在一个 Markdown 代码块中**。

请开始处理。
IGNORE_WHEN_COPYING_START
content_copy
download
Use code with caution.
IGNORE_WHEN_COPYING_END
